<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Beats</title>
	<link rel="stylesheet" href="style.css">
	<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,900&display=swap&subset=cyrillic" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" integrity="sha256-UhQQ4fxEeABh4JrcmAJ1+16id/1dnlOEVCFOxDef9Lw=" crossorigin="anonymous" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css" integrity="sha256-kksNxjDRxd/5+jGurZUJd1sdR2v+ClrCl3svESBaJqw=" crossorigin="anonymous" />
</head>
<body>

	<div class="overlay" style='display: none;'>
		<div class="wrapper-dialog">

			<div class="dialog">
				<div class="dialog-title">ВСПЛЫВАХА В БОЧИНУ</div>
				
				<form action="" class="form">
					<input type="text" class="input" placeholder="Диктуй цифры..">	
					<div class="submit-wrapper">
						<svg enable-background="0 0 512 512" version="1.1" viewBox="0 0 512 512" xml:space="preserve" xmlns="http://www.w3.org/2000/svg">
							<path d="m481.51 210.34-413.09-171.41c-17.403-7.222-37.064-4.045-51.309 8.287-14.245 12.334-20.203 31.338-15.547 49.595l36.769 144.19h180.03c8.284 0 15.001 6.716 15.001 15.001 0 8.284-6.716 15.001-15.001 15.001h-180.03l-36.769 144.19c-4.656 18.258 1.301 37.262 15.547 49.595 14.274 12.357 33.937 15.495 51.31 8.287l413.09-171.41c18.808-7.804 30.491-25.302 30.491-45.665s-11.683-37.862-30.492-45.665z"/>
						</svg>
						<input type="submit" class="submit" value=''>
					</div>
				</form>
			</div>

		</div>
	</div>



	<div class="wrapper">
		<div class="header-wrapper">
			<header class="header">
				<div class="nav-wrapper" style='background-color: rgba(255,255,255,0);'>
					<div class="logo">
						<span class="big">МАИ</span>
						<br>
						<span class="small">БЕТОЧКИ</span>
					</div>
					<nav class="nav">
						<a href="#" class="nav-link">Новинки</a>
						<a href="#" class="nav-link">Отзывы</a>
						<a href="#" class="nav-link">Контакты</a>
					</nav>
					<button class="btn">Оставить Заявку</button>
				</div> 
			</header>
		</div>
		<main class="main">
			<div class="screen">
				<div class="screen-text-wrapper">
					<h1 class="main-title">
						Как ты собрался читать без битов?</h1>
					<div class="subtitle">
						Жареные гвозди в каждый дом. Бесконконтактная доставка. нужны котлеты для обложки. продам гараж.
					</div>
				</div>
				<div class="screen-image-wrapper">
						<img src="skovorodochka.png" alt="" class="screen-image">	
				</div>
			</div>

			<div class="audio-screen">
				<h2 class="screen-title">Жареные гвозди на развес&#10071;&#10071;&#10071;</h2>
				<div class="beats">
					
					<div class="audio">
						<h3 class="audio-title">001</h3>
						<span class="rating">&#128293;&#128293;&#128293;</span>
						<audio class='audio-src' src="guitarshort.mp3"></audio>
						
						<div class="audio-line">
							<div class="audio-line-fill"></div>
							<div class="audio-line-handle"></div>

							<div class="audio-line-currentTime">00:00</div>
							<div class="audio-line-totalTime">00:29</div>
						</div>
						<button class="audio-play">
							<img src="play-button.png" alt="" class='play-button'>
							<img src="pause.png" alt="" class="pause-button" style='display: none;'>
						</button>
					</div>

					<div class="audio">
						<h3 class="audio-title">001</h3>
						<span class="rating">&#128293;&#128293;&#128293;</span>
						<audio class='audio-src' src="guitarshort.mp3"></audio>
						
						<div class="audio-line">
							<div class="audio-line-fill"></div>
							<div class="audio-line-handle"></div>

							<div class="audio-line-currentTime">00:00</div>
							<div class="audio-line-totalTime">00:29</div>
						</div>
						<button class="audio-play">
							<img src="play-button.png" alt="" class='play-button' style='display: none;'>
							<img src="pause.png" alt="" class="pause-button" >
						</button>
					</div>


	
					
					
					</div>	
				</div>

				<div class="comments-section">
					<h2 class="screen-title">Отзывы клиентуры</h2>
					
					<div class="comment-box">
						<div class="comment" style='right: 120%;opacity:0;' >
							<div class="comment-image" style='background-image: url(skovorodochka.png)'></div>
							<div class="comment-author">Мой брат</div>
							<div class="comment-text">Пацанский реп Пацанский реп Пацанский реп Пацанский реп Пацанский реп Пацанский реп Пацанский реп Пацанский реп Пацанский реп Пацанский реп Пацанский реп Пацанский реп Пацанский реп Пацанский реп </div>
						</div>
						<div class="comment" style='right: 0%;opacity: 1;'>
							<div class="comment-image"></div>
							<div class="comment-author">Мой брат</div>
							<div class="comment-text">Пацанский реп</div>
						</div>
						<div class="comment" style='right: -120%;opacity: 0;'>
							<div class="comment-image"></div>
							<div class="comment-author">Мой брат</div>
							<div class="comment-text"></div>
						</div>
						
					</div>
					<button class="next">
						<img src="arrow-2.png" alt="">
					</button>
				</div>
		</main>
	</div>
	<!-- 
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js" integrity="sha256-pTxD+DSzIwmwhOqTFN+DB+nHjO4iAsbgfyFq5K5bcE0=" crossorigin="anonymous"></script> -->
	<!-- <script>
		$('.owl-carousel').owlCarousel({
			loop:true,
			margin:10,
			nav:true,
			autoWidth:true,
			center: true,
		});
	</script> -->
	<script>
		(function() {
			const comments = [].slice.call(document.querySelectorAll('.comment'));
			const next = document.querySelector('.next');

			let len = comments.length;
			let cur = 1, prev = (cur + len - 2) % len;

			next.addEventListener('click', function() {

				cur = (cur + 1) % len;
				prev = (cur - 2 + len) % len;

				comments.forEach(function(comment) {
					comment.style.right = parseInt(comment.style.right) + 120 + '%';
					if (comment.style.right == '0%') comment.style.opacity = 1;
					else comment.style.opacity = 0;
				});

				comments[prev].style.right = -(len - 2) * 120 + '%';
			});

		})();
	</script>


	<script>
		const overlay = document.querySelector('.overlay');
		const wrapperDialog = document.querySelector('.wrapper-dialog');
		const btn = document.querySelector('.btn');
		const dialog = document.querySelector('.dialog');

		btn.onclick = function() {
			if (overlay.style.display == 'none') {
				wrapperDialog.style.top = window.scrollY + 'px';
				overlay.style.display = 'block';
				setTimeout(function() {
					dialog.classList.add('v_bochinu');
					overlay.classList.add('overlay-visible');
				}, 10);
			}
			else {
				closeDialog();
			}
		}

		function closeDialog() {
			dialog.classList.remove('v_bochinu');
			overlay.classList.remove('overlay-visible');
			setTimeout(function() {
				overlay.style.display = 'none';
			}, 500);
		}

		overlay.onclick = function(event) {
			if (event.target == overlay) closeDialog();
		}
		wrapperDialog.onclick = function(event) {
			if (event.target == wrapperDialog) closeDialog();
		}


		const wrapper = document.querySelector('.nav-wrapper');
		const audios = document.querySelectorAll('.audio');

		function formatTime(seconds){
			var min3 = Math.floor(seconds/60);
			var sec3 = seconds % 60;
			min3 = (min3 < 10) ? "0" + min3 : min3;
			sec3 = (sec3 < 10) ? "0"  + sec3 : sec3;
			
			return min3 + ':' + sec3;
		}

		function set_time(track, bar, current_time, handle) {
			let position = track.currentTime / track.duration;
			bar.style.width = position * 100 + '%';
			current_time.textContent = formatTime(Math.round(track.currentTime));
			handle.style.left = position * 100 + '%';
		}



		for (let audio of audios) {
			let play_audio = audio.querySelector('.audio-play');
			let track      = audio.querySelector('.audio-src');
			let audio_bar  = audio.querySelector('.audio-line-fill');
			let audio_line = audio.querySelector('.audio-line');
			let audio_current_time = audio.querySelector('.audio-line-currentTime');
			let audio_handle = audio.querySelector('.audio-line-handle');
			let play_btn = audio.querySelector('.play-button');
			let pause_btn = audio.querySelector('.pause-button');

			audio_line.onclick = function(e) {
				if (track.ended) return;

				let mouse_position = e.pageX - audio_bar.offsetLeft - audio.offsetLeft;
				console.log( audio_bar.offsetLeft);
				console.log( audio_line.offsetLeft);
				track.currentTime = mouse_position * track.duration / audio_line.offsetWidth;
				audio_bar.style.width = mouse_position + 'px';	

			}

			play_audio.onclick = function() {
				if (track.paused) {
					track.play();
					play_btn.style.display = 'none';
					pause_btn.style.display = 'block';

					track.addEventListener('timeupdate', set_time.bind(null, track, audio_bar, audio_current_time, audio_handle));
				} else {
					track.pause();
					play_btn.style.display = 'block';
					pause_btn.style.display = 'none';
				} 
			}
		}



		// bar3.addEventListener('click',function(e){
		// 		if(!song3.ended){
		// 			var mouseX3 = e.pageX - bar3.offsetLeft - lens3.offsetLeft;
		// 			var newtime3 = mouseX3 * song3.duration/barSize3;
		// 			song3.currentTime = newtime3;
		// 			fillBar3.style.width = mouseX3 + 'px';	
		// 		}		
		// });

		window.addEventListener('scroll', function(e) {
			console.log(window.scrollY);
			if(window.scrollY < 100)
			{
				wrapper.style.paddingLeft = window.scrollY/3 + 'px';
				wrapper.style.paddingRight = window.scrollY/3 + 'px';
				wrapper.style.backgroundColor = 'rgba(255,255,255,' + window.scrollY/50 + ')';
				wrapper.style.boxShadow = `${Math.max(window.scrollY/10, 0)}px ${-Math.max(window.scrollY/10, 0)}px 0 0 #222`;
				wrapper.style.borderWidth = `${window.scrollY/50}px`;
			}
			else 
			{
				wrapper.style.backgroundColor = 'rgba(255,255,255)';
				wrapper.style.paddingLeft = '33px';
				wrapper.style.paddingRight = '33px';
				wrapper.style.boxShadow = '10px -10px 0 0 #222';
				wrapper.style.borderWidth = `2px`;
			}
		}); 
	</script>
</body>
</html>